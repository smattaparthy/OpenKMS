@page "/trainings"
@rendermode InteractiveServer
@using OpenKMS.Services
@inject OpenKMS.Services.AuthService AuthService
@inject NavigationManager NavigationManager

<PageTitle>Trainings - OpenKMS</PageTitle>

<section class="d-flex flex-column gap-4">
    <!-- Header -->
    <div class="card">
        <div class="card-body">
            <h1 class="card-title" style="font-size: var(--text-3xl);">Available Trainings</h1>
            <p class="card-text">Browse and register for upcoming training sessions</p>
        </div>
    </div>

    <!-- Filters -->
    <div class="card">
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12 col-md-6 col-lg-3">
                    <label class="form-label" for="search">Search</label>
                    <InputText id="search" @bind-Value="searchText" type="text" placeholder="Search trainings..." class="form-control" />
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <label class="form-label" for="category">Category</label>
                    <select id="category" class="form-select">
                        <option value="">All Categories</option>
                        <option value="SECURITY">Security</option>
                        <option value="LEADERSHIP">Leadership</option>
                        <option value="TECHNICAL">Technical</option>
                        <option value="COMPLIANCE">Compliance</option>
                    </select>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <label class="form-label" for="level">Level</label>
                    <select id="level" class="form-select">
                        <option value="">All Levels</option>
                        <option value="BEGINNER">Beginner</option>
                        <option value="INTERMEDIATE">Intermediate</option>
                        <option value="ADVANCED">Advanced</option>
                    </select>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <label class="form-label" for="status">Status</label>
                    <select id="status" class="form-select">
                        <option value="">All Status</option>
                        <option value="PUBLISHED">Published</option>
                        <option value="DRAFT">Draft</option>
                    </select>
                </div>
            </div>
            <div class="d-flex justify-content-end mt-3">
                <button class="btn btn-primary">
                    Apply Filters
                </button>
            </div>
        </div>
    </div>

    <!-- Training Cards -->
    <div class="row g-4">
        <!-- Training Card 1 -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge badge-primary">SECURITY</span>
                        <span class="badge" style="background-color: var(--color-success-light); color: var(--color-success-dark);">PUBLISHED</span>
                    </div>
                    <h3 class="card-title" style="font-size: var(--text-xl);">Security Awareness Training</h3>
                    <p class="card-text">Comprehensive security awareness covering data protection, threat identification, and best practices.</p>

                    <div class="d-flex flex-column gap-2 mb-3 text-secondary" style="font-size: var(--text-sm);">
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üóìÔ∏è</span>
                            Dec 15, 2023 ‚Ä¢ 10:00 AM
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üìç</span>
                            Conference Room A
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">‚è±Ô∏è</span>
                            2 hours ‚Ä¢ 1 credit
                        </div>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <span class="text-secondary" style="font-size: var(--text-sm);">12/15 spots available</span>
                        <button class="btn btn-primary btn-sm">Register Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Card 2 -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge badge-primary">LEADERSHIP</span>
                        <span class="badge" style="background-color: var(--color-success-light); color: var(--color-success-dark);">PUBLISHED</span>
                    </div>
                    <h3 class="card-title" style="font-size: var(--text-xl);">Leadership Development Workshop</h3>
                    <p class="card-text">Enhance your leadership skills with practical strategies for team management and decision making.</p>

                    <div class="d-flex flex-column gap-2 mb-3 text-secondary" style="font-size: var(--text-sm);">
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üóìÔ∏è</span>
                            Dec 20, 2023 ‚Ä¢ 2:00 PM
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üìç</span>
                            Training Room B
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">‚è±Ô∏è</span>
                            4 hours ‚Ä¢ 2 credits
                        </div>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <span class="text-secondary" style="font-size: var(--text-sm);">8/20 spots available</span>
                        <button class="btn btn-primary btn-sm">Register Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Card 3 -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge badge-primary">COMPLIANCE</span>
                        <span class="badge" style="background-color: var(--color-success-light); color: var(--color-success-dark);">PUBLISHED</span>
                    </div>
                    <h3 class="card-title" style="font-size: var(--text-xl);">Data Privacy Best Practices</h3>
                    <p class="card-text">Learn essential data privacy principles and regulatory compliance requirements for modern organizations.</p>

                    <div class="d-flex flex-column gap-2 mb-3 text-secondary" style="font-size: var(--text-sm);">
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üóìÔ∏è</span>
                            Dec 22, 2023 ‚Ä¢ 11:00 AM
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üìç</span>
                            Virtual Training
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">‚è±Ô∏è</span>
                            3 hours ‚Ä¢ 1 credit
                        </div>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <span class="text-secondary" style="font-size: var(--text-sm);">15/25 spots available</span>
                        <button class="btn btn-primary btn-sm">Register Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Card 4 -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge badge-primary">TECHNICAL</span>
                        <span class="badge" style="background-color: var(--color-warning-light); color: var(--color-warning-dark);">DRAFT</span>
                    </div>
                    <h3 class="card-title" style="font-size: var(--text-xl);">Advanced Project Management</h3>
                    <p class="card-text">Master advanced project management methodologies including Agile, Scrum, and DevOps integration.</p>

                    <div class="d-flex flex-column gap-2 mb-3 text-secondary" style="font-size: var(--text-sm);">
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üóìÔ∏è</span>
                            Jan 5, 2024 ‚Ä¢ 9:00 AM
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">üìç</span>
                            Conference Room C
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="me-2" aria-hidden="true">‚è±Ô∏è</span>
                            8 hours ‚Ä¢ 3 credits
                        </div>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <span class="text-secondary" style="font-size: var(--text-sm);">Coming Soon</span>
                        <button class="btn btn-secondary btn-sm" disabled>Registration Closed</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <nav class="d-flex align-items-center justify-content-between pt-2" aria-label="Trainings pagination">
        <div class="text-secondary" style="font-size: var(--text-sm);">
            Showing <span class="fw-semibold">1</span> to <span class="fw-semibold">4</span> of <span class="fw-semibold">12</span> results
        </div>
        <ul class="pagination m-0">
            <li class="page-item disabled"><a class="page-link" href="javascript:void(0)">Previous</a></li>
            <li class="page-item active"><a class="page-link" href="javascript:void(0)">1</a></li>
            <li class="page-item"><a class="page-link" href="javascript:void(0)">2</a></li>
            <li class="page-item"><a class="page-link" href="javascript:void(0)">3</a></li>
            <li class="page-item"><a class="page-link" href="javascript:void(0)">Next</a></li>
        </ul>
    </nav>
</section>

@code {
    private string searchText { get; set; } = "";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var isAuthenticated = await AuthService.IsAuthenticatedAsync();
            if (!isAuthenticated)
            {
                NavigationManager.NavigateTo("/login");
            }
        }
    }
}